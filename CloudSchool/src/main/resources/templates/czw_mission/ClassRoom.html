<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.arg">
<html>

	<head>
		<meta charset="UTF-8">
		<title>教室管理</title>
		<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
		<link rel="stylesheet" th:href="@{/static/css/bootstrap.min.css}">
		<link rel="stylesheet" th:href="@{/static/css/ready.css}">
		<link rel="stylesheet" th:href="@{/static/css/load.css}">
		<style>
			.card-footer div{
				float: right;
			}
			#hezi {
				position: absolute;
				left: 0;
				top: 0;
				background: #f2f3f8;
				width: 100%;
				height: 100%;
				z-index: 9999;
			}
		</style>
	</head>

	<body>
		<div class="main-panel">
		<div id="hezi">
			<div class="spinner">
				<div class="spinner-container container1">
					<div class="circle1"></div>
					<div class="circle2"></div>
					<div class="circle3"></div>
					<div class="circle4"></div>
				</div>
				<div class="spinner-container container2">
					<div class="circle1"></div>
					<div class="circle2"></div>
					<div class="circle3"></div>
					<div class="circle4"></div>
				</div>
				<div class="spinner-container container3">
					<div class="circle1"></div>
					<div class="circle2"></div>
					<div class="circle3"></div>
					<div class="circle4"></div>
				</div>
			</div>
		</div> 
			<div class="content">
				<div class="container-fluid">
					<h4 class="page-title col-lg-12 col-xs-6">教室管理</h4>
					<div class="card col-lg-12">
						<div class="card-header">
							<h4 class="card-title">
								查看教室
							</h4>
							<a infoBut moduleUrl="/mission/addClassRoom" th:href="@{/mission/toInsertClr}" style="float:right;">新增教室</a>
						</div>
						<div class="card-body">
							<table class="table mt-3">
								<thead>
									<tr>
										<th scope="col">教室名称</th>
										<th scope="col">教室类型</th>
										<th scope="col">容纳人数</th>
										<th scope="col">教室楼层</th>
										<th scope="col">操作</th>
									</tr>
								</thead>
								<tbody>
									<!-- <tr th:each="m:${list}">
										<td th:text="${m.name}"></td>
										<td th:text="${m.ctname}"></td>
										<td th:text="${m.galleryful}"></td>
										<td th:text="${m.floor}"></td>
										<td><a infoBut moduleUrl="/mission/delete" href="javascript:void(0)" class="del" th:value="${m.id}">删除</a>
											<a infoBut moduleUrl="/mission/updateClassRoom" th:href="@{/mission/selectByid(id=${m.id})}" >修改</a></td>
									</tr> -->
									<tr v-for="(p,index) in page.list">									
										<td>{{p.name}}</td>
										<td>{{p.ctname}}</td>
										<td>{{p.galleryful}}</td>
										<td>{{p.floor}}</td>
										<td><a infoBut moduleUrl="/mission/delete" href="javascript:void(0)" v-bind:value="p.id" v-on:click="deleteinfo(p.id)">删除</a>
											<a infoBut moduleUrl="/mission/updateClassRoom" href="javascript:void(0)" v-on:click="updateinfo(p.id)">修改</a></td>
									</tr>
									<!-- <tr>
										<td>402</td>
										<td>上课室</td>
										<td>30</td>
										<td>4</td>
										<td><a href="insertclassroom.html">删除</a><a href="updateclassroom.html">修改</a></td>
									</tr>
									<tr>
										<td>412</td>
										<td>自习室</td>
										<td>30</td>
										<td>4</td>
										<td><a href="insertclassroom.html">删除</a><a href="updateclassroom.html">修改</a></td>
									</tr> -->
								</tbody>
							</table>
								
						</div>
						<div class="card-footer">
							<div class="card-body">
								<div id="pagebox">
									<p class="demo">
									<ul class="pagination pg-primary">
										<li class="page-item"><a class="page-link"
											href="javascript:void(0)" v-on:click="getPage(1)" aria-label="Previous"
											id="previousPage"> <span aria-hidden="true">&laquo;</span>
												<span class="sr-only">Previous</span>
										</a></li>
										<li   v-for="(n,index) in page.pageCount" v-bind:class="n == page.presentPage ? 'page-item active' : 'page-item'"><a class="page-link" href="#" v-on:click="getPage(index+1)">{{n}}</a>
										</li>
										<li class="page-item"><a class="page-link"
											href="javascript:void(0)" v-on:click="getPage(page.pageCount)" aria-label="Next" id="nextPage">
												<span aria-hidden="true">&raquo;</span> <span
												class="sr-only">Next</span>
										</a></li>
									</ul>
									</p>
								</div>
							</div>
						</div>
					</div>
			</div>
		</div>
	</body>
<script th:src="@{/static/js/core/jquery.3.2.1.min.js}"></script>
<script th:src="@{/static/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js}"></script>
<script th:src="@{/static/js/core/popper.min.js}"></script>
<script th:src="@{/static/js/core/bootstrap.min.js}"></script>
<script th:src="@{/static/js/plugin/chartist/chartist.min.js}"></script>
<script th:src="@{/static/js/plugin/chartist/plugin/chartist-plugin-tooltip.min.js}"></script>
<script th:src="@{/static/js/plugin/bootstrap-notify/bootstrap-notify.min.js}"></script>
<script th:src="@{/static/js/plugin/bootstrap-toggle/bootstrap-toggle.min.js}"></script>
<script th:src="@{/static/js/plugin/jquery-mapael/jquery.mapael.min.js}"></script>
<script th:src="@{/static/js/plugin/jquery-mapael/maps/world_countries.min.js}"></script>
<script th:src="@{/static/js/plugin/chart-circle/circles.min.js}"></script>
<script th:src="@{/static/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js}"></script>
<script th:src="@{/static/js/ready.min.js}"></script>
<script th:src="@{/static/js/cqj_infoBut.js}"></script>
<script th:src="@{/static/js/core/vue.js}" type="text/javascript"
	charset="utf-8"></script>
<script>
var v = new Vue({
	el : ".content",
	data : {
		page : {}
	},
	watch : {
		page:function(){
			this.$nextTick(function () {
				infoBut.ccc();
				//infoBut.fadeOut(); 
				console.log(sumCount+":"+count)
		})
		}
	},
	methods : {
		getPage : function(index) {
			getPage(index);
		},
		updateinfo:function(id){
			location.href="/mission/selectByid?id="+id;
		},
		deleteinfo:function(id){
			
			$.ajax({
				url:"delClassRoom",
            	data:"id="+id,
            	success:function(result){
            		if(result==1){
            			alert("删除成功");
            			location.href="queryClr"
            		}else{
            			alert("删除失败");
            		}
            		
            	}
			}) 
		}
	}
});
var count = 0;
var sumCount=1;
	$(function(){
		getPage(1);
	})
	
	function getPage(i) {
		$("#hezi").show();
		console.log(sumCount+":"+count)
		if(count!=0){
			count--;
		}
		var json = {};
		json.cur = i;
		$.ajax({
			url : "/mission/getPage",
			data : json,
			type : "post",
			dataType : "json",
			success : function(data) {
				console.log(data)
				if(data!="404"){
					v.page = data;
				}
			}
		})
	}
</script>
</html>